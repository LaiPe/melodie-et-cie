{% macro pricing(columns=3, plans=[], features=[]) -%}
  <style>
  /* ===== PRICING GRID (scoped) ===== */
  .pricing-grid {
    display: grid;
    gap: 1.25rem;
    grid-template-columns: repeat(var(--cols, 3), minmax(220px, 1fr));
    align-items: start;
  }

  .pricing-card {
    background: #fff;
    border-radius: 12px;
    padding: 1.25rem;
    box-shadow: 0 8px 24px rgba(0,0,0,0.06);
    text-align: left;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }

  .pricing-card__header {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
  }

  .pricing-card__title {
    font-weight: 700;
    color: #2c3e50;
    font-size: 1.05rem;
  }

  .pricing-card__price {
    font-weight: 800;
    color: #2b6cb0;
    font-size: 1.05rem;
  }

  .pricing-card__features {
    margin-top: 0.5rem;
    display: grid;
    gap: 0.45rem;
  }

  .pricing-feature {
    display: flex;
    gap: 0.6rem;
    align-items: center;
    color: #444;
    font-size: 0.95rem;
  }

  .pricing-feature .icon {
    width: 18px;
    height: 18px;
    flex: 0 0 18px;
    display: inline-block;
  }

  .pricing-feature.ok { color: #2f855a; }
  .pricing-feature.no { color: #b93b3b; opacity: 0.85; }

  @media (max-width: 768px){
    .pricing-grid { grid-template-columns: repeat(2, minmax(180px,1fr)); }
  }
  @media (max-width: 480px){
    .pricing-grid { grid-template-columns: 1fr; }
  }
  </style>

  <div class="pricing-grid" style="--cols: {{ columns | int }};">
    {% for plan in plans %}
      <article class="pricing-card" aria-label="Forfait {{ plan.title }}">
        <div class="pricing-card__header">
          <div class="pricing-card__title">{{ plan.title }}</div>
          {% if plan.price %}<div class="pricing-card__price">{{ plan.price }}</div>{% endif %}
        </div>

        <div class="pricing-card__features" role="list">
          {% for feat in features %}
            {% set included = (plan.details and (feat.title in plan.details)) %}
            <div class="pricing-feature {{ 'ok' if included else 'no' }}" role="listitem" aria-checked="{{ 'true' if included else 'false' }}">
              {% if included %}
                <span class="icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>
                </span>
              {% else %}
                <span class="icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                </span>
              {% endif %}
              <span class="pricing-feature__text">{{feat.emoji}} {{ feat.title }}</span>
            </div>
          {% endfor %}
        </div>
      </article>
    {% endfor %}
  </div>
{%- endmacro %}